---
#   /    Context:                     https://ctx.ist
# ,'`./    do you remember?
# `.,'\
#   \    Copyright 2026-present Context contributors.
#                 SPDX-License-Identifier: Apache-2.0

title: Upgrading ctx
icon: lucide/arrow-up-circle
---

![ctx](images/ctx-banner.png)

## Upgrading ctx

New versions of `ctx` may ship updated hooks, skills, permissions,
CLAUDE.md directives, or Makefile targets. A version upgrade means
getting the new binary **and** regenerating the infrastructure it
installs into your project.

## What Changes Between Versions

`ctx init` generates two categories of files:

| Category           | Examples                                                                                                                                        | Changes between versions?     |
|--------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
| **Infrastructure** | `.claude/hooks/`, `.claude/skills/`, `Makefile.ctx`, `.claude/settings.local.json`, ctx-managed sections in `CLAUDE.md` and `PROMPT.md`         | Yes                           |
| **Knowledge**      | `.context/TASKS.md`, `DECISIONS.md`, `LEARNINGS.md`, `CONVENTIONS.md`, `ARCHITECTURE.md`, `GLOSSARY.md`, `CONSTITUTION.md`, `AGENT_PLAYBOOK.md` | **No**: this is **your** data |

Infrastructure is regenerated by `ctx init`. Knowledge files are yours
and should never be overwritten.

## Upgrade Steps

### 1. Back Up

```bash
cp -r .context .context.bak
cp -r .claude .claude.bak
cp CLAUDE.md CLAUDE.md.bak
cp PROMPT.md PROMPT.md.bak
```

### 2. Install the New Version

Build from source or download the binary:

```bash
cd /path/to/ctx-source
git pull
make build
sudo make install
ctx --version   # verify
```

### 3. Reinitialize

```bash
ctx init --force --merge
```

`--force` regenerates infrastructure files (hooks, skills, settings,
Makefile.ctx). `--merge` preserves your content outside ctx markers in
`CLAUDE.md` and `PROMPT.md`.

### 4. Restore Knowledge Files

```bash
cp .context.bak/TASKS.md          .context/
cp .context.bak/DECISIONS.md      .context/
cp .context.bak/LEARNINGS.md      .context/
cp .context.bak/CONVENTIONS.md    .context/
cp .context.bak/ARCHITECTURE.md   .context/
cp .context.bak/GLOSSARY.md       .context/
cp .context.bak/CONSTITUTION.md   .context/
cp .context.bak/AGENT_PLAYBOOK.md .context/
```

Also restore any data directories:

```bash
# Session and journal data (if present)
cp -r .context.bak/sessions/ .context/sessions/ 2>/dev/null
cp -r .context.bak/journal/  .context/journal/  2>/dev/null

# Scratchpad key (never regenerate — you'd lose encrypted data)
cp .context.bak/.scratchpad.key .context/ 2>/dev/null
cp .context.bak/.scratchpad.enc .context/ 2>/dev/null
```

### 5. Review Custom Settings

If you added custom hooks or permissions to `.claude/settings.local.json`
beyond what `ctx init` provides, diff and merge:

```bash
diff .claude.bak/settings.local.json .claude/settings.local.json
```

Manually add back any custom entries that the new init dropped.

### 6. Verify

```bash
ctx status          # context files intact
ctx drift           # no broken references
```

### 7. Clean Up

Once satisfied, remove the backups:

```bash
rm -rf .context.bak .claude.bak CLAUDE.md.bak PROMPT.md.bak
```

## What If I Skip the Upgrade?

The old binary still works with your existing `.context/` files. But you
may miss:

- **New hooks** that enforce better practices or catch mistakes
- **Updated skill prompts** that produce better results
- **New `.gitignore` entries** for directories added in newer versions
- **Bug fixes** in the CLI itself

Context files are plain Markdown — they never break between versions.
The surrounding infrastructure is what evolves.

## Quick Reference

```bash
# Full upgrade (recommended)
cp -r .context .context.bak && cp -r .claude .claude.bak
# install new ctx
ctx init --force --merge
cp .context.bak/{TASKS,DECISIONS,LEARNINGS,CONVENTIONS,\
  ARCHITECTURE,GLOSSARY,CONSTITUTION,AGENT_PLAYBOOK}.md .context/
cp .context.bak/.scratchpad.key .context/ 2>/dev/null
rm -rf .context.bak .claude.bak
```
